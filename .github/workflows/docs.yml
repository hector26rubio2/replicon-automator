name: Deploy Documentation to GitHub Pages

on:
  push:
    branches: [main]
    paths:
      - 'README.md'
      - 'docs/**'
      - '.github/workflows/docs.yml'
  workflow_dispatch:

# Permisos m√≠nimos necesarios
permissions:
  contents: read
  pages: write
  id-token: write

# Cancelar ejecuciones duplicadas
concurrency:
  group: pages-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    name: Build Documentation
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup Pages
        uses: actions/configure-pages@v4
      
      - name: Generate modern landing page
        run: |
          mkdir -p docs-site
          
          cat > docs-site/index.html <<'EOF'
          <!DOCTYPE html>
          <html lang="es">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Replicon Automator - Automatizaci√≥n de Tiempos</title>
            <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
            <style>
              * { margin: 0; padding: 0; box-sizing: border-box; }
              body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 2rem;
              }
              .card {
                background: white;
                border-radius: 24px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                max-width: 800px;
                width: 100%;
                padding: 3rem;
                animation: fadeIn 0.6s ease-out;
              }
              @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
              }
              h1 {
                font-size: 3rem;
                font-weight: 900;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-bottom: 1rem;
                line-height: 1.2;
              }
              .subtitle {
                font-size: 1.5rem;
                color: #64748b;
                margin-bottom: 2rem;
                font-weight: 600;
              }
              .features {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1.5rem;
                margin: 2rem 0;
              }
              .feature {
                padding: 1.5rem;
                background: #f8fafc;
                border-radius: 12px;
                border-left: 4px solid #667eea;
              }
              .feature h3 {
                font-size: 1.1rem;
                margin-bottom: 0.5rem;
                color: #1e293b;
              }
              .feature p {
                color: #64748b;
                font-size: 0.9rem;
              }
              .badges {
                display: flex;
                flex-wrap: wrap;
                gap: 0.75rem;
                margin: 2rem 0;
              }
              .badge {
                display: inline-flex;
                align-items: center;
                padding: 0.5rem 1rem;
                background: #667eea;
                color: white;
                border-radius: 20px;
                font-size: 0.875rem;
                font-weight: 600;
              }
              .cta-buttons {
                display: flex;
                gap: 1rem;
                margin-top: 2rem;
              }
              .btn {
                padding: 1rem 2rem;
                border-radius: 12px;
                font-weight: 700;
                text-decoration: none;
                display: inline-block;
                transition: transform 0.2s, box-shadow 0.2s;
              }
              .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 20px rgba(0,0,0,0.2);
              }
              .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
              }
              .btn-secondary {
                background: white;
                color: #667eea;
                border: 2px solid #667eea;
              }
              .stats {
                display: flex;
                justify-content: space-around;
                margin-top: 2rem;
                padding-top: 2rem;
                border-top: 2px solid #e2e8f0;
              }
              .stat {
                text-align: center;
              }
              .stat-number {
                font-size: 2rem;
                font-weight: 900;
                color: #667eea;
              }
              .stat-label {
                color: #64748b;
                margin-top: 0.5rem;
              }
            </style>
          </head>
          <body>
            <div class="card">
              <h1>üöÄ Replicon Automator</h1>
              <p class="subtitle">Automatiza tu registro de tiempos con tecnolog√≠a moderna</p>
              
              <div class="badges">
                <span class="badge">‚ö° Electron 39</span>
                <span class="badge">‚öõÔ∏è React 18</span>
                <span class="badge">üìò TypeScript</span>
                <span class="badge">üé≠ Playwright</span>
              </div>
              
              <div class="features">
                <div class="feature">
                  <h3>üéØ Interfaz Moderna</h3>
                  <p>UI responsive con React y Electron</p>
                </div>
                <div class="feature">
                  <h3>‚ö° Ultra R√°pido</h3>
                  <p>Automatizaci√≥n con Playwright</p>
                </div>
                <div class="feature">
                  <h3>üìä Editor CSV</h3>
                  <p>Edita datos directamente en la app</p>
                </div>
                <div class="feature">
                  <h3>üìù Plantillas</h3>
                  <p>Semanas predefinidas y personalizables</p>
                </div>
              </div>
              
              <div class="cta-buttons">
                <a href="https://github.com/hector26rubio2/replicon-automator/releases/latest" class="btn btn-primary">
                  üì• Descargar √öltima Versi√≥n
                </a>
                <a href="https://github.com/hector26rubio2/replicon-automator" class="btn btn-secondary">
                  üìñ Ver en GitHub
                </a>
              </div>
              
              <div class="stats">
                <div class="stat">
                  <div class="stat-number">v3.6.2</div>
                  <div class="stat-label">Versi√≥n Actual</div>
                </div>
                <div class="stat">
                  <div class="stat-number">675</div>
                  <div class="stat-label">Tests Passing</div>
                </div>
                <div class="stat">
                  <div class="stat-number">22.6%</div>
                  <div class="stat-label">Coverage</div>
                </div>
              </div>
            </div>
          </body>
          </html>
          EOF
          
          echo "‚úÖ Documentaci√≥n generada exitosamente"
      
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: docs-site
          retention-days: 1  # Eliminar despu√©s de deploy para $0 storage

  deploy:
    name: Deploy to Pages
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
